95a96,99
> ! LSODAR - individual tolerances
> real(dk),allocatable  ::  atols(:)
> real(dk),allocatable  ::  rtols(:)
> 
121c125
< call SET_SOLV(integ,eqs,tol,isett,iwork,rwork)
---
> call SET_SOLV(integ,eqs,neq,tol,isett,iwork,rwork,rtols,atols)
128,129c132,133
<         call INTLOOP(COWELL_RHS,COWELL_EVT,integ,eqs,neq,y0,x0,dx,tstep,yx,tol,&
<         &tol,isett,liw,iwork,lrw,rwork)
---
>         call INTLOOP(COWELL_RHS,COWELL_EVT,integ,eqs,neq,y0,x0,dx,tstep,yx,rtols,&
>         &atols,isett,liw,iwork,lrw,rwork)
132,133c136,137
<         call INTLOOP(EDROMO_RHS,EDROMO_EVT,integ,eqs,neq,y0,x0,dx,tstep,yx,tol,&
<         &tol,isett,liw,iwork,lrw,rwork)
---
>         call INTLOOP(EDROMO_RHS,EDROMO_EVT,integ,eqs,neq,y0,x0,dx,tstep,yx,rtols,&
>         &atols,isett,liw,iwork,lrw,rwork)
190c194
< real(dk),intent(in)  ::  rtol,atol             ! Integration tolerances
---
> real(dk),intent(in)  ::  rtol(:),atol(:)       ! Integration tolerances
222,226c226,230
<     ! Print message every print_each steps
<     if (i_print - print_each == 0) then
<       write(*,'(a,f9.2,a)') 'Progress: ',real(iint)/real(nsteps)*100.,'%'
<       i_print = 0
<     end if
---
>     ! ! Print message every print_each steps
>     ! if (i_print - print_each == 0) then
>     !   write(*,'(a,f9.2,a)') 'Progress: ',real(iint)/real(nsteps)*100.,'%'
>     !   i_print = 0
>     ! end if
